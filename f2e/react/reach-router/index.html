<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Reach Router | Curly的Blog</title>
    <meta name="generator" content="VuePress 1.5.3">
    <link rel="icon" href="/blog/favicon.png">
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?bee8141d3226bf8abf76962d6e22700f";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    <meta name="description" content="记录探索历程">
    <link rel="preload" href="/blog/assets/css/0.styles.5563ef6a.css" as="style"><link rel="preload" href="/blog/assets/js/app.26fc4076.js" as="script"><link rel="preload" href="/blog/assets/js/3.ce09a418.js" as="script"><link rel="preload" href="/blog/assets/js/36.4e3750d2.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.000c3a5a.js"><link rel="prefetch" href="/blog/assets/js/11.23cac595.js"><link rel="prefetch" href="/blog/assets/js/12.459bc8a4.js"><link rel="prefetch" href="/blog/assets/js/13.8452325d.js"><link rel="prefetch" href="/blog/assets/js/14.da7da709.js"><link rel="prefetch" href="/blog/assets/js/15.575f202a.js"><link rel="prefetch" href="/blog/assets/js/16.cccaed16.js"><link rel="prefetch" href="/blog/assets/js/17.f8164258.js"><link rel="prefetch" href="/blog/assets/js/18.43ebccc3.js"><link rel="prefetch" href="/blog/assets/js/19.3eace7bd.js"><link rel="prefetch" href="/blog/assets/js/20.19941b97.js"><link rel="prefetch" href="/blog/assets/js/21.ea82998b.js"><link rel="prefetch" href="/blog/assets/js/22.8e4a4dcf.js"><link rel="prefetch" href="/blog/assets/js/23.6c824cc8.js"><link rel="prefetch" href="/blog/assets/js/24.44726bc0.js"><link rel="prefetch" href="/blog/assets/js/25.9e53a540.js"><link rel="prefetch" href="/blog/assets/js/26.8b48df03.js"><link rel="prefetch" href="/blog/assets/js/27.fdbf6a61.js"><link rel="prefetch" href="/blog/assets/js/28.4f51147e.js"><link rel="prefetch" href="/blog/assets/js/29.6b40e241.js"><link rel="prefetch" href="/blog/assets/js/30.b74fb900.js"><link rel="prefetch" href="/blog/assets/js/31.37a9419d.js"><link rel="prefetch" href="/blog/assets/js/32.839d367e.js"><link rel="prefetch" href="/blog/assets/js/33.b4454420.js"><link rel="prefetch" href="/blog/assets/js/34.ad790a2f.js"><link rel="prefetch" href="/blog/assets/js/35.f838384b.js"><link rel="prefetch" href="/blog/assets/js/37.c22b2402.js"><link rel="prefetch" href="/blog/assets/js/38.a7a25ed2.js"><link rel="prefetch" href="/blog/assets/js/39.e592901e.js"><link rel="prefetch" href="/blog/assets/js/4.61109045.js"><link rel="prefetch" href="/blog/assets/js/40.4f2875d3.js"><link rel="prefetch" href="/blog/assets/js/41.09fe9516.js"><link rel="prefetch" href="/blog/assets/js/42.0a6e916c.js"><link rel="prefetch" href="/blog/assets/js/43.ddaf5642.js"><link rel="prefetch" href="/blog/assets/js/44.e5199151.js"><link rel="prefetch" href="/blog/assets/js/45.bca4d4ee.js"><link rel="prefetch" href="/blog/assets/js/46.153a2ad5.js"><link rel="prefetch" href="/blog/assets/js/47.fb28f0b2.js"><link rel="prefetch" href="/blog/assets/js/48.d4f07cbc.js"><link rel="prefetch" href="/blog/assets/js/49.394be70c.js"><link rel="prefetch" href="/blog/assets/js/5.9ffc748a.js"><link rel="prefetch" href="/blog/assets/js/50.2e61a56e.js"><link rel="prefetch" href="/blog/assets/js/51.1c2fb955.js"><link rel="prefetch" href="/blog/assets/js/52.82ba7481.js"><link rel="prefetch" href="/blog/assets/js/53.ed882701.js"><link rel="prefetch" href="/blog/assets/js/54.398d6da4.js"><link rel="prefetch" href="/blog/assets/js/55.794daf79.js"><link rel="prefetch" href="/blog/assets/js/56.89d51571.js"><link rel="prefetch" href="/blog/assets/js/57.e8a4be2f.js"><link rel="prefetch" href="/blog/assets/js/58.189383d5.js"><link rel="prefetch" href="/blog/assets/js/59.33750545.js"><link rel="prefetch" href="/blog/assets/js/6.25303515.js"><link rel="prefetch" href="/blog/assets/js/60.51a24775.js"><link rel="prefetch" href="/blog/assets/js/61.9c63febc.js"><link rel="prefetch" href="/blog/assets/js/62.1db2569d.js"><link rel="prefetch" href="/blog/assets/js/7.8ca2edb7.js"><link rel="prefetch" href="/blog/assets/js/8.44f91d42.js"><link rel="prefetch" href="/blog/assets/js/9.48ece269.js"><link rel="prefetch" href="/blog/assets/js/vendors~flowchart.6dfce6e9.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.5563ef6a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Curly的Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/f2e/" class="nav-link router-link-active">
  前端技术
</a></div><div class="nav-item"><a href="/blog/algo/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/blog/explore/" class="nav-link">
  探索
</a></div><div class="nav-item"><a href="https://github.com/curlywater" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/f2e/" class="nav-link router-link-active">
  前端技术
</a></div><div class="nav-item"><a href="/blog/algo/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/blog/explore/" class="nav-link">
  探索
</a></div><div class="nav-item"><a href="https://github.com/curlywater" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/f2e/" aria-current="page" class="sidebar-link">目录</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>React</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/f2e/react/react-document/" class="sidebar-link">React知识体系</a></li><li><a href="/blog/f2e/react/react-component-lifecycle/" class="sidebar-link">React组件的生命周期</a></li><li><a href="/blog/f2e/react/react-hook/" class="sidebar-link">React Hook 使用介绍</a></li><li><a href="/blog/f2e/react/react-and-react-dom/" class="sidebar-link">React与ReactDOM分别做了什么？</a></li><li><a href="/blog/前端技术/React/少量组件应用方案.html" class="sidebar-link">少量组件应用方案</a></li><li><a href="/blog/f2e/react/react-router/" class="sidebar-link">React Router 记录</a></li><li><a href="/blog/f2e/react/reach-router/" aria-current="page" class="active sidebar-link">Reach Router</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/f2e/react/reach-router/#reach-router-v2" class="sidebar-link">Reach Router v2</a></li><li class="sidebar-sub-header"><a href="/blog/f2e/react/reach-router/#设计特点" class="sidebar-link">设计特点</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/f2e/react/reach-router/#依赖组件嵌套关系" class="sidebar-link">依赖组件嵌套关系</a></li><li class="sidebar-sub-header"><a href="/blog/f2e/react/reach-router/#智能计算优先级" class="sidebar-link">智能计算优先级</a></li><li class="sidebar-sub-header"><a href="/blog/f2e/react/reach-router/#设计优势" class="sidebar-link">设计优势</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/f2e/react/reach-router/#api" class="sidebar-link">API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/f2e/react/reach-router/#router" class="sidebar-link">&lt;Router&gt;</a></li><li class="sidebar-sub-header"><a href="/blog/f2e/react/reach-router/#route-component" class="sidebar-link">Route Component</a></li><li class="sidebar-sub-header"><a href="/blog/f2e/react/reach-router/#location" class="sidebar-link">location</a></li><li class="sidebar-sub-header"><a href="/blog/f2e/react/reach-router/#link" class="sidebar-link">&lt;Link&gt;</a></li><li class="sidebar-sub-header"><a href="/blog/f2e/react/reach-router/#redirect" class="sidebar-link">Redirect</a></li><li class="sidebar-sub-header"><a href="/blog/f2e/react/reach-router/#match" class="sidebar-link">Match</a></li><li class="sidebar-sub-header"><a href="/blog/f2e/react/reach-router/#navigate" class="sidebar-link">navigate</a></li><li class="sidebar-sub-header"><a href="/blog/f2e/react/reach-router/#hooks" class="sidebar-link">Hooks</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>模块化和构建工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>源码解读</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>项目记录</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="reach-router"><a href="#reach-router" class="header-anchor">#</a> Reach Router</h1> <h2 id="reach-router-v2"><a href="#reach-router-v2" class="header-anchor">#</a> Reach Router v2</h2> <blockquote><p>Reach Router and it’s sibling project React Router are merging as React Router v6. In other words, Reach Router v2 and React Router v6 are the same. There is more information on the maintainers website.</p></blockquote> <p>根据Reach Router官网的信息，Reach Router 未来将和React Router合并，计划在React Router v6版本实现。</p> <h2 id="设计特点"><a href="#设计特点" class="header-anchor">#</a> 设计特点</h2> <h3 id="依赖组件嵌套关系"><a href="#依赖组件嵌套关系" class="header-anchor">#</a> 依赖组件嵌套关系</h3> <p>Reach Router最大的特点在于，依赖组件嵌套关系组织路由。这样的设计便利之处在于：</p> <ul><li>把路由和组件融合在一起，不需要通过<code>&lt;Route&gt;</code>组件设定路径和组件的对应关系</li> <li>路由设定和导航时直接使用相对地址，Reach Router自行组装成绝对路径</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Logo <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Router<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Home path<span class="token operator">=</span><span class="token string">&quot;/&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>About path<span class="token operator">=</span><span class="token string">&quot;about&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Support path<span class="token operator">=</span><span class="token string">&quot;support&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Dash path<span class="token operator">=</span><span class="token string">&quot;dashboard&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>DashHome path<span class="token operator">=</span><span class="token string">&quot;/&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Invoices path<span class="token operator">=</span><span class="token string">&quot;invoices&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Team path<span class="token operator">=</span><span class="token string">&quot;team&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Dash<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Home<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>上面的代码，路径<code>/dashboard/invoices</code>最终的渲染结构是<code>&lt;Home&gt; -&gt; &lt;Dash&gt; -&gt; &lt;Invoices&gt;</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">Dash</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Dashboard<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>nav<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;invoices&quot;</span><span class="token operator">&gt;</span>Invoices<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token string">&quot; &quot;</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;team&quot;</span><span class="token operator">&gt;</span>Team<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>nav<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>hr <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">{</span>children<span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>

<span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>Router<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Home path<span class="token operator">=</span><span class="token string">&quot;/&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Dash path<span class="token operator">=</span><span class="token string">&quot;dashboard&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Invoices path<span class="token operator">=</span><span class="token string">&quot;invoices&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Team path<span class="token operator">=</span><span class="token string">&quot;team&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Dash<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>上面这段代码，点击Invoices超链接，跳转至<code>/dashborad/invoices</code></p> <h3 id="智能计算优先级"><a href="#智能计算优先级" class="header-anchor">#</a> 智能计算优先级</h3> <p>Reach Router的另一个特点是智能计算模糊路径的匹配优先级，不需要人为设置优先级（设置<code>exact</code>或调整路由顺序）。</p> <p>智能计算的实现原理其实类似于CSS选择器优先级，计算路径的权重，然后决定有限顺序。权重规则：</p> <ul><li>一个字段：4分</li> <li>是静态字段：再加3分</li> <li>是动态字段：再加2分</li> <li>是根字段：再加1分</li> <li>是通配符： 减1分</li></ul> <p>比如，路径<code>/groups/:groupId/users/*</code>，得分是19分，包含3个字段，两个静态字段，一个动态字段，还有一个通配符。4 * 3 + 2 * 3 + 2 - 1 = 19。</p> <p>更多具体例子可见<a href="https://reach.tech/router/ranking" target="_blank" rel="noopener noreferrer">Path Ranking<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h3 id="设计优势"><a href="#设计优势" class="header-anchor">#</a> 设计优势</h3> <p>Reach Router这样的设计有助于大项目拆分，路由不再受限于顶层配置，而是可以分块独立。</p> <ol><li>团队可以把大项目分成小功能分别开发，开发完成后直接将项目组装合并即可</li> <li>动态加载模块：借助Loadable或<code>import()</code>，当匹配到路径时再动态加载对应模块</li> <li>在测试时也可以独立进行，无需考虑整体路由牵制</li> <li>组件可灵活重用到不同路由场景</li></ol> <h2 id="api"><a href="#api" class="header-anchor">#</a> API</h2> <h3 id="router"><a href="#router" class="header-anchor">#</a> <code>&lt;Router&gt;</code></h3> <p>路由组件，Reach Router只支持history API和Memory两种历史记录管理方式，对应浏览器环境和非浏览器环境。选择哪种方式由Reach Router判断。</p> <p><code>&lt;Router&gt;</code>的属性：</p> <ul><li><code>children: elements</code>：所有子孙组件都是Route Component</li> <li><code>basepath: string</code>：基本路径</li> <li><code>primary: bool</code>：在多路由情况下，是否作为主路由存在。</li></ul> <p>特殊应用场景：</p> <ul><li>一个路径在不同区域使用，渲染两个Router。<a href="https://reach.tech/router/example/multiple-routers" target="_blank" rel="noopener noreferrer">示例代码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Router嵌套，外层路由尾随通配符，表示在其子组件中额外细分路由。<a href="https://reach.tech/router/example/nested-routes" target="_blank" rel="noopener noreferrer">示例代码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="route-component"><a href="#route-component" class="header-anchor">#</a> <code>Route Component</code></h3> <p>可用属性：</p> <ul><li><code>path=&quot;/&quot;</code>，该路径下的Index Path，索引页</li> <li><code>default</code>，Not Found</li></ul> <p>接收到的props：</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token punctuation">{</span>
  <span class="token punctuation">[</span>param<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  uri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  navigate<span class="token operator">:</span> func<span class="token punctuation">,</span>
  location<span class="token operator">:</span> object
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="location"><a href="#location" class="header-anchor">#</a> location</h3> <p>location包含当前位置信息，以下面这段数据演示<code>location</code>的内容</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  href<span class="token operator">:</span> <span class="token string">&quot;https://lyzwj8w0qz.csb.app/&quot;</span>
  ancestorOrigins<span class="token operator">:</span> DOMStringList
  origin<span class="token operator">:</span> <span class="token string">&quot;https://lyzwj8w0qz.csb.app&quot;</span>
  protocol<span class="token operator">:</span> <span class="token string">&quot;https:&quot;</span>
  host<span class="token operator">:</span> <span class="token string">&quot;lyzwj8w0qz.csb.app&quot;</span>
  hostname<span class="token operator">:</span> <span class="token string">&quot;lyzwj8w0qz.csb.app&quot;</span>
  port<span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
  pathname<span class="token operator">:</span> <span class="token string">&quot;/&quot;</span>
  search<span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
  hash<span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
  <span class="token function-variable function">assign</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function-variable function">reload</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function-variable function">toString</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function-variable function">replace</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">replace</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    time<span class="token operator">:</span> Fri Sep <span class="token number">04</span> <span class="token number">2020</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">22</span> <span class="token constant">GMT</span><span class="token operator">+</span><span class="token number">0800</span> <span class="token punctuation">(</span>China Standard Time<span class="token punctuation">)</span>
    key<span class="token operator">:</span> <span class="token string">&quot;1599208050780&quot;</span>
  <span class="token punctuation">}</span>
  key<span class="token operator">:</span> <span class="token string">&quot;1599208050780&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="link"><a href="#link" class="header-anchor">#</a> <code>&lt;Link&gt;</code></h3> <p>导航组件</p> <p><code>&lt;Link&gt;</code>的属性：</p> <ul><li><code>to: string</code>：支持相对和绝对路径</li> <li><code>replace: bool</code>：是否替代历史记录栈中的当前记录</li> <li><code>ref: func</code>：React &gt;= 16.4</li> <li><code>innerRef: fun</code>：React &lt; 16.4</li> <li><code>getProps: func(obj)</code>: 根据obj信息返回一些props
<ul><li><code>isCurrent: bool</code>：路径是否完全匹配</li> <li><code>isPartiallyCurrent: bool</code>：路径是否部分匹配</li> <li><code>href: string</code>：绝对路径</li> <li><code>location: obj</code>：当前的位置对象</li></ul></li> <li><code>state: object</code>：需要传输的一些信息，接收组件需要通过<code>location.state</code>获取信息</li></ul> <p><code>getProps</code>示例代码</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">isActive</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> isCurrent <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> isCurrent <span class="token operator">?</span> <span class="token punctuation">{</span> className<span class="token operator">:</span> <span class="token string">&quot;active&quot;</span> <span class="token punctuation">}</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">ExactNavLink</span> <span class="token operator">=</span> <span class="token parameter">props</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>Link getProps<span class="token operator">=</span><span class="token punctuation">{</span>isActive<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>state</code>示例代码</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">NewsFeed</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Link
      to<span class="token operator">=</span><span class="token string">&quot;photos/123&quot;</span>
      state<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> fromFeed<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">Photo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> location<span class="token punctuation">,</span> photoId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>location<span class="token punctuation">.</span>state<span class="token punctuation">.</span>fromFeed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>FromFeedPhoto id<span class="token operator">=</span><span class="token punctuation">{</span>photoId<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Photo id<span class="token operator">=</span><span class="token punctuation">{</span>photoId<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="redirect"><a href="#redirect" class="header-anchor">#</a> <code>Redirect</code></h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>Router<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Dash path<span class="token operator">=</span><span class="token string">&quot;dashboard&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Redirect <span class="token keyword">from</span><span class="token operator">=</span><span class="token string">&quot;profile/:userId&quot;</span> to<span class="token operator">=</span><span class="token string">&quot;/&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Dash<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>匹配到用户页直接重定向到首页。</p> <h3 id="match"><a href="#match" class="header-anchor">#</a> <code>Match</code></h3> <p>无论是否匹配都会进入回调，回调props接收<code>match</code></p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>match<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token punctuation">{</span>
	<span class="token punctuation">[</span>param<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
	uri<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token comment">// uri中匹配的部分</span>
	path<span class="token operator">:</span> <span class="token builtin">string</span>
	location<span class="token operator">:</span> object
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Match <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@reach/router&quot;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>Match path<span class="token operator">=</span><span class="token string">&quot;/hot/:item&quot;</span><span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token parameter">props</span> <span class="token operator">=&gt;</span>
      props<span class="token punctuation">.</span>match <span class="token operator">?</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Hot <span class="token punctuation">{</span>props<span class="token punctuation">.</span>match<span class="token punctuation">.</span>item<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Uncool<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Match<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="navigate"><a href="#navigate" class="header-anchor">#</a> navigate</h3> <ul><li><code>const navigate = useNavigate()</code>/<code>import { navigate } from &quot;@reach/router&quot;</code>，需要传入绝对路径</li> <li><code>props.navigate</code>，使用相对路径，会根据嵌套路径自动生成绝对路径</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>navigate<span class="token operator">:</span> <span class="token function">func</span><span class="token punctuation">(</span>to<span class="token operator">:</span> string <span class="token operator">|</span> number<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  state<span class="token operator">:</span> object<span class="token punctuation">,</span>
  replace<span class="token operator">:</span> boolean
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">navigate</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">navigate</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">navigate</span><span class="token punctuation">(</span><span class="token string">&quot;user/1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token string">&quot;A&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="hooks"><a href="#hooks" class="header-anchor">#</a> Hooks</h3> <ul><li><code>useNavigate</code>：获取全局导航函数</li> <li><code>useParams</code>：获取当前路由的<code>params</code></li> <li><code>useMatch</code>：使用当前<code>location</code>匹配指定<code>path</code></li> <li><code>useLocation</code>：获取<code>location</code></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2020年9月4日 09:09</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/f2e/react/react-router/" class="prev">
        React Router 记录
      </a></span> <span class="next"><a href="/blog/f2e/typescript/vscode/">
        在 VS Code 中使用 TypeScript
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.26fc4076.js" defer></script><script src="/blog/assets/js/3.ce09a418.js" defer></script><script src="/blog/assets/js/36.4e3750d2.js" defer></script>
  </body>
</html>
